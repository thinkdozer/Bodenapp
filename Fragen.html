<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body onclick="solve()">
        <h1>Fragen</h1>
        <h2>Bodenart</h2>
        <p>Welche Bodenart liegt auf ihren Flächen vor? <br> Wählen sie ihre Bodenart:</p>
        <form class="boden">
          <div>
              <input type="radio" id="boden::Sand" name="boden">
              <label for="boden::Sand">schluffiger Sand</label>
          </div>
          <div>
              <input type="radio" id="boden::lehmSand" name="boden">
              <label for="boden::lehmSand">lehmiger Sand / sandiger Schluff</label>
          </div>
          <div>
              <input type="radio" id="boden::Schluff" name="boden">
              <label for="boden::Schluff">sandiger Lehm / Schluff</label>
          </div>
          <div>
              <input type="radio" id="boden::schluffLehm" name="boden">
              <label for="boden::schluffLehm">lehmiger Schluff / Lehm / toniger Schluff</label>
          </div>
          <div>
              <input type="radio" id="boden::Lehm" name="boden">
              <label for="boden::Lehm">toniger Lehm / schluffiger Ton</label>
          </div>
          <div>
              <input type="radio" id="boden::liteTon" name="boden">
              <label for="boden::liteTon">lehmiger Ton / schluffiger Ton</label>
          </div>
          <div>
              <input type="radio" id="boden::Ton" name="boden">
              <label for="boden::Ton">Ton</label>
          </form>
        </div>
          <h2>Standort</h2>
            <p>Denken Sie an die letzten Jahre zurück: Wie ist der Niederschlag auf ihrem Standort im Vergleich zu anderen Regionen ausgefallen? <br>Es war eher: </p>
            <from class="standort">
            <div>
              <input type="radio" id="Standort::Naß" name="standort">
              <label for="Standort::Naß">Naß</label>
            </div>
            <div>
              <input type="radio" id="Standort::Trocken" name="standort">
              <label for="Standort::Trocken">Trocken</label>
            </div>
          </form>
        <h2>Probe nehmen</h2>
          <p>Nehmen sie von einem Acker. auf dem sie den Humusgehalt bestimmen wollen, eine Bodenprobe. Achten Sie bei der anschließenden Untersuchung auf folgende Punkte: </p>
          <div class="indented1">
          <h3>Geruchsprobe</h3>
            <p>Zu welchen der folgenden Kategorien lässt sich der Geruch ihrer Probe am ehesten zuordnen?</p>
            <div>
              <input type="radio" id="Geruch::modrich" name="geruch">
              <label class="clickbox" for="Geruch::modrich">modrich / erdig</label>
            </div>
            <div>
              <input type="radio" id="Geruch::moorig" name="geruch">
              <label for="Geruch::moorig">sauer / moorig</label>
            </div>
            <div>
                <input type="radio" id="Geruch::nichts" name="geruch">
                <label for="Geruch::nichts">neutral</label>
            </div>
          <h3>Lebewesen</h3>
            <p>Die Dichte und Anzahl von Lebewesen in Böden deutet darauf hin, wie viel Humus in einem Boden vorliegt. Diese sorgen für eine Auflockerung des Bodens und eine schnellere Zersetzung der Ernterückstände:  </p>
            <div>
              <input type="checkbox" id="Lebewesen::Haufen" name="lebewesen">
              <label for="Lebewesen::Haufen">sehen sie Regenwurmhaufen</label>
            </div>
            <div>
              <input type="checkbox" id="Lebewesen::Gaenge" name="click me">
              <label for="Lebewesen::Gaenge">sehen sie Gänge in der Probe</label>
            </div>

          <h3>Ernterückstände</h3>
            <p>Betrachten sie ihre Probe genau. <br>Wie sehen Ernterückstände in der Erde aus?</p>
            <div>
              <input type="radio" id="Rückstände::vermodert" name="rückstände">
              <label for="Rückstände::vermodert">sind Ernterückstände fast verschwunden</label>
            </div>
            <div>
              <input type="radio" id="Rückstände::ganz" name="rückstände">
              <label for="Rückstände::ganz">sind Ernterückstände noch vorhanden</label>
            </div>
        <h2>Fruchtfolge</h2>
        <div>
          <div>
            <input type="radio" id="Fruchtfolge::humuszehrer" name="humuszehrer">
            <label for="Fruchtfolge::humuszehrer">Haben sie viele Humuszehrer in ihrer Fruchtfolge?</label>
          </div>
          <div>
            <input type="radio" id="Fruchtfolge::humusgeber" name="humuszehrer">
            <label for="Fruchtfolge::humusgeber">Haben sie viele Humusgeber in ihrer Fruchtfolge?</label>
          </div>
        </div>
          <div>
            <input type="checkbox" id="Fruchtfolge::nebenprodukte" name="click me">
            <label for="Fruchtfolge::nebenprodukte">Fahren sie Nebenprodukte ab?</label>
          </div>
          <div>
            <input type="checkbox" id="Fruchtfolge::zwischenfrüchte" name="click me">
            <label for="Fruchtfolge::zwischenfrüchte">Bauen sie Zwischenfrüchte an?</label>
          </div>
          <div>
            <input type="checkbox" id="Fruchtfolge::pfluglos" name="click me">
            <label for="Fruchtfolge::pfluglos">Reduzieren sie Arbeiten mit dem Pflug?</label>
          </div>
          <div>
            <input type="checkbox" id="Fruchtfolge::organik" name="click me">
            <label for="Fruchtfolge::organik">Bringen sie organischen Dünger aus?</label>
          </div>
          <div>
            <input type="checkbox" id="Fruchtfolge::legominosen" name="click me">
            <label for="Fruchtfolge::legominosen">Bauen sie Legominosen an?</label>
          </div>
        <h2>Nährstoffspeicherfähigkeit</h2>
          <div>
            <input type="radio" id="Nährstoffe::dünger_gut" name="dünger">
            <label for="Nährstoffe::dünger_gut">Zeigt Dünger eine gute Wirkung?</label>
          </div>
          <div>
            <input type="radio" id="Nährstoffe::dünger_schlecht" name="dünger">
            <label for="Nährstoffe::dünger_schlecht">Zeigt Dünger nur eine mäßige Wirkung?</label>
          </div>
          <div>
            <input type="checkbox" id="Nährstoffe::vergleichbar" name="click me">
            <label for="Nährstoffe::vergleichbar">Sind ihre Erträge vergleichbar mit Feldnachbarn?</label>
          </div>
        <h2>Wasserspeicherfähigkeit</h2>
          <div>
            <input type="radio" id="Wasserspeicherfähigkeit::schnell" name="dränend">
            <label for="Wasserspeicherfähigkeit::schnell">Verschwindet Wasser schnell im Boden und ist die Erden nach Regenperioden trotzdem trocken?</label>
          </div>
          <div>
            <input type="radio" id="Wasserspeicherfähigkeit::langsam" name="dränend">
            <label for="Wasserspeicherfähigkeit::langsam">Bleibt Wasser nach Regen noch lange im Boden?</label>
          </div>
          <div>
            <input type="checkbox" id="Wasserspeicherfähigkeit::trockenperioden">
            <label for="Wasserspeicherfähigkeit::trockenperioden">Haben sie auch in Trockenperioden gute Erträge?</label>
          </div>
        <hr></hr>
        <h2>Humusgehalt</h2>
        <div class="result">
          <p id="result"><p>
        </div>
        <p>*dies ist aber nur eine grobe Schätzung basierend auf ihren Angaben, um einen genaueren Wert zu ermitteln wenden sie bitte die Brennprobe oder die pH-Bestimmung an</p>
        <script src="values.js"></script>
        <script>

          
          function unset_all(){
            //unsets all checkboxes and radios at start
            console.log("unset_all()");
            let obj = getvalues("all");
            for (let theme in obj){
              let assigns = obj[theme].assigns;
              for (let id in assigns) {
                //console.log(" id: " + id);
                document.getElementById(id).checked = false;
              }
            }
          }


          function extr_radio_2(obj, hum){
            //changes amount of humus from a group of radios
            console.log("extr_radio_2(" + obj + ")");
            console.log(obj);
            console.log("obj.calculation = " + obj.calculation);
            let assigns = obj.assigns;
            console.log("assigns: ");
            console.log(assigns);
            for (const i in assigns){
              let name = `${i}`;
              console.log(`${i}` + ": " + document.getElementById(`${i}`).checked);
              if (document.getElementById(`${i}`).checked){
                var boden = assigns[name];
                console.log("set boden to: " + boden);
              }

            }
            if (boden == undefined) {
              boden = obj.fallback;
            }
            if (obj.calculation == "overwrite") {
              console.log("extr_radio_2(): overwrite hum");
              hum = boden;
            }else if (obj.calculation == "addition") {
              console.log("added boden: " + boden + "to hum: " + hum);
              hum = Number(hum) + Number(boden);
            }
            return(hum);
          }
          function extr_checkbox(obj, hum){
            //changes amount of humus from a group of checkboxey
            console.log("extr_checkbox(" + obj + ")");
            console.log(obj);
            console.log("obj.calculation = " + obj.calculation);
            let assigns = obj.assigns;
            console.log("assigns: ");
            console.log(assigns);
            for (const i in assigns){
              let name = `${i}`;
              if (document.getElementById(`${i}`).checked) {
                var part_hum = assigns[name];
                if (obj.calculation == "addition") {
                  hum = Number(hum) + Number(part_hum);
                }else if (obj.calculation == "overwrite") {
                  hum = Number(part_hum);
                } else{
                  console.log("Err: no calculation type in " + obj);
                }
              }
            }
            return(hum);
          }
          function solve(){
            //sets humus amount; runs on every click
            console.log("solve()");
            let obj = getvalues("amount");
            var hum = 10;
            for (const i in obj){
              let div = `${i}`;
              console.log("type: " + obj[div].type);
              if (obj[div].type == "radio") {
                  console.log("solve(): radio");
                  hum = extr_radio_2(obj[div], hum);
              }else if (obj[div].type == "checkbox") {
                hum = extr_checkbox(obj[div], hum);
              } else {
                console.log("Err: wrong type in " + obj[div]);
                break;
              }
              console.log(" hum = " + hum);
            }
            hum = hum / 10;
            console.log("solve(): hum = " + hum);
            document.getElementById("result").innerHTML = hum + "%";
            let type = getvalues("type");
            for (var geruchsort in type["geruch"].assigns){
              if (document.getElementById(geruchsort).checked) {
                var geruchszuordnung = type["geruch"].assigns[geruchsort];
                document.getElementById("result").innerHTML = document.getElementById("result").innerHTML + ", wo von ein großer Anteil " + geruchszuordnung + " ist.";
              }
            }
            console.log(" geruchszuordnung: " + geruchszuordnung);
          }
          unset_all();
          solve();
        </script>
        <script>
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker
              .register('/service-worker.js')
              .then((registration) => {
                console.log(`Service Worker Registered at scope: ${registration.scope}`);
              })
              .catch((error) => {
                console.error(`Service Worker failed registration: ${error}`);
              })
          }
        </script>

    </body>
</html>
